"use strict";angular.module("config",[]).constant("ENV",{name:"development",apiEndpoint:"http://rad-magento-16.dev",defaultLang:"fr"}),window.scrollTo(0,1),angular.module("angularApp",["ngAnimate","ngCookies","ngMessages","ngResource","ngRoute","ngSanitize","ngTouch","pascalprecht.translate","xml","config","nl2br"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/index.html",controller:"MainCtrl"}).when("/login",{templateUrl:"views/auth/login.html",controller:"LoginCtrl"}).when("/connexion",{templateUrl:"views/auth/connexion.html",controller:"ConnexionCtrl"}).when("/logout",{templateUrl:"views/auth/logout.html",controller:"LogoutCtrl"}).when("/register",{templateUrl:"views/auth/register.html",controller:"RegisterCtrl"}).when("/lost-password",{templateUrl:"views/auth/lost-password.html",controller:"LostPasswordCtrl"}).when("/my-account/orders",{templateUrl:"views/account/my-orders.html",controller:"MyOrdersCtrl"}).otherwise({redirectTo:"/"})}]).config(["$httpProvider",function(a){a.interceptors.push("xmlHttpInterceptor")}]).config(["$translateProvider",function(a){var b={TITLE:"Rad.co",APP_NAME:"Rad",login:{with_facebook:"Se connecter avec Facebook",or_register_email:"Connexion ou inscription par e-mail"},form:{submit:"Valider"},error:{connexion_lost:"Problème de connexion, veuillez re-essayer plus tard."},connexion:{form:{legend:"Veillez saisir vos identifiants de connexion.","email.placeholder":"Adresse email","password.placeholder":"Mot de passe"},facebook:"Se connecter avec facebook"},register:{new_account:"Créer un nouveau compte",title:"Inscription",facebook:"S'inscrire avec Facebook",form:{legend:"Merci de renseigner tous les champs suivantes.","firstname.placeholder":"Prénom","lastname.placeholder":"Nom","email.placeholder":"Adresse email","password.placeholder":"Mot de passe","birthday.placeholder":"31/12/2000","cell.placeholder":"06 06 06 06 06"}},lostpass:{title:"Aide","form.legend":"Veuillez renseigner votre adresse e-mail.","form.email.placeholder":"Adresse e-mail.",success:"Un e-mail vient d’être envoyé à {{email}} afin de rénitialiser votre mot de passe."},menu:{title:"Menu",cart:"Panier",profile:"Profil",orders:"Mes commandes",payments:"Paiement",addresses:"Mes adresses",free_orders:"Commande offerte",help:"Aide",logout:"Déconnexion"},"":""},c=function(a,b,d){return angular.forEach(b,function(b,e){"string"==typeof b?a[d+e]=b:a=c(a,b,d+e+".")}),a};a.translations("fr",c({},b,"")),a.preferredLanguage("fr"),a.useSanitizeValueStrategy(null)}]),angular.module("angularApp").controller("MainCtrl",["$scope",function(a){}]),angular.module("angularApp").directive("splashScreen",function(){return{restrict:"A",link:function(a,b){angular.element(document).ready(function(){b.remove()})}}}),angular.module("angularApp").controller("LoginCtrl",["$scope",function(a){}]),angular.module("angularApp").controller("ConnexionCtrl",["$scope","User","$location",function(a,b,c){a.title="Connexion",a.email="",a.password="",a.loading=!1,a.error=null,a.submitForm=function(){return a.loading=!0,a.error=null,b.login(a.email,a.password).then(function(b){"success"==b.message.status?c.path("/"):(a.loading=!1,a.error=b.message.text)},function(){a.error="error.connexion_lost"}),!1}}]),angular.module("angularApp").controller("RegisterCtrl",["$scope","User","$location",function(a,b,c){a.title="Connexion",a.firstname="",a.lastname="",a.email="",a.password="",a.loading=!1,a.error=null,a.errors=null;var d=function(){return{email:a.email,password:a.password,confirmation:a.password,is_subscribed:!0,firstname:a.firstname,lastname:a.lastname}};a.submitForm=function(){a.loading=!0,a.error=null,a.errors=null,b.register(d()).then(function(b){"success"==b.message.status?c.path("/"):(a.loading=!1,a.errors=b.message.text)},function(){a.loading=!1,a.error="error.connexion_lost"})}}]),angular.module("angularApp").controller("LostPasswordCtrl",["$scope","User","$timeout","$location",function(a,b,c,d){a.title="lostpass.title",a.email="",a.loading=!1,a.error=null,a["false"]=!0,a.submitForm=function(){a.loading=!0,a.error=null,b.forgotPassword(a.email).then(function(b){a.loading=!1,"success"==b.message.status?(a.success="lostpass.success",a.error=null,a.translateData={email:a.email},c(function(){d.path("/")},5e3)):a.error=b.message.text},function(){a.loading=!1,a.error="error.connexion_lost"})}}]),angular.module("angularApp").controller("LogoutCtrl",["$scope","$location","User","$timeout",function(a,b,c,d){c.logout(),d(function(){b.path("/")},2e3)}]),angular.module("angularApp").service("CurrentUser",function(){return{}}),angular.module("angularApp").factory("User",["$http","ApiLink","MagentoPostRequest","$cookies","responseHandler",function(a,b,c,d,e){var f="_token_user",g=d.get(f)||null,h=function(b){g=b,b?(d.put(f,b),a.defaults.headers.common.Authorization='token="'+b+'"'):(d.remove(f),delete a.defaults.headers.common.Authorization)},i=function(a){return e.success(a,function(a){a.data.message.token&&h(a.data.message.token)})},j=function(a,d){return c(b.get("customer","login"),{username:a,password:d},g).then(i,e.error)},k=function(a){return c(b.get("customer","save"),a,g).then(i,e.error)},l=function(a){return c(b.get("customer","forgotpassword"),{email:a},g).then(i,e.error)},m=function(){return a({method:"GET",url:b.get("customer","logout"),headers:{Authorization:'token="'+g+'"'}}).then(h(null))};return{login:j,logout:m,register:k,forgotPassword:l,getToken:function(){return(g||"")+""}}}]),angular.module("angularApp").service("ApiLink",["ENV","Lang",function(a,b){var c=function(c,d){return a.apiEndpoint+"/"+b.get()+"/xmlconnect/"+c+"/"+d+"/app_code/"+b.getAppCode()};return{get:c}}]),angular.module("angularApp").service("Lang",["ENV","$cookies",function(a,b){var c="fr us uk de".split(" "),d=b.get("lang")||a.defaultLang,e=function(){return d},f=function(a){a=a.toLowerCase();for(var b=0;b<c.length;b++)if(c[b]===a.toLowerCase()){d=a;break}return d};return{get:e,set:f,getAppCode:function(){return"fr_iph1"}}}]),angular.module("angularApp").service("MagentoPostRequest",["$http","$httpParamSerializer",function(a,b){return function(c,d,e){var f={"Content-Type":"application/x-www-form-urlencoded"};return e&&(f.Authorization='token="'+e+'"'),a({method:"POST",url:c,headers:f,data:b(d)})}}]),angular.module("angularApp").directive("loader",function(){return{template:'<div class="loader-directive"><div class="loader"></div></div>'}}),angular.module("angularApp").directive("menuTop",function(){return{templateUrl:"views/directives/menutop.html",restrict:"E",link:function(a,b,c){}}}),angular.module("angularApp").directive("menuLeftBtn",["User","$rootScope",function(a,b){var c=angular.element("html");return b.$on("$routeChangeStart",function(){c.removeClass("left-open")}),{templateUrl:"views/directives/menuleftbtn.html",restrict:"E",link:function(b,d){var e=d.find(".left-menu-opener");a.getToken()?e.click(function(a){a.preventDefault(),c.toggleClass("left-open")}):e.attr("href","#/login")}}}]),angular.module("angularApp").controller("MyOrdersCtrl",["$scope","User","$location",function(a,b,c){return b.getToken()?(a.loading=!0,void(a.orders=[])):c.path("/login")}]),angular.module("angularApp").factory("order",["User","$http","responseHandler",function(a,b,c){var d=function(){return c.handle(b({method:"GET",url:ApiLink.get("customer","orderlist")}))};return{list:d}}]),angular.module("angularApp").service("responseHandler",["$q",function(a){var b=function(b,c){return"object"==typeof b.data?("function"==typeof c&&c(b),b.data):a.reject(b.data)},c=function(b){a.reject(b.data)},d=function(a){return a.then(b,c)};return{success:b,error:c,handle:d}}]);